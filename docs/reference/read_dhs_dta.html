<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read DHS Stata data set — read_dhs_dta • rdhs</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Read DHS Stata data set — read_dhs_dta" />

<meta property="og:description" content="This function reads a DHS recode dataset from the zipped Stata dataset. By default (`mode = "haven"`),
it reads in the stata data set using read_dta" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rdhs</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown-header">Articles</li>
<li>
  <a href="../articles/introduction.html">Introduction to rdhs (Overview)</a>
</li>
<li>
  <a href="../articles/anemia.html">An example use case looking at trends in anemia</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read DHS Stata data set</h1>
    
    <div class="hidden name"><code>read_dhs_dta.Rd</code></div>
    </div>

    
    <p>This function reads a DHS recode dataset from the zipped Stata dataset. By default (`mode = "haven"`),
it reads in the stata data set using <code><a href='http://www.rdocumentation.org/packages/haven/topics/read_dta'>read_dta</a></code></p>
    

    <pre class="usage"><span class='fu'>read_dhs_dta</span>(<span class='no'>zfile</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"haven"</span>, <span class='kw'>all_lower</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>zfile</th>
      <td><p>Path to `.zip` file containing Stata dataset, usually ending in filename `XXXXXXDT.zip`</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>Read mode for Stata `.dta` file. Defaults to "haven", see 'Details' for other options.</p></td>
    </tr>
    <tr>
      <th>all_lower</th>
      <td><p>Logical indicating whether all value labels should be lower case. Default to `TRUE`.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments to be passed to <code><a href='read_zipdata.html'>read_zipdata</a></code>. Here this will be arguments to
pass to either <code><a href='http://www.rdocumentation.org/packages/haven/topics/read_dta'>read_dta</a></code> or <code><a href='http://www.rdocumentation.org/packages/foreign/topics/read.dta'>read.dta</a></code> depending on the mode provided</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame. If mode = 'map', value labels for each variable are stored as the `labelled` class from `haven`.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The default `mode="haven"` uses  <code><a href='http://www.rdocumentation.org/packages/haven/topics/read_dta'>read_dta</a></code> to read in the dataset. We have chosen this
option as it is more consistent with respect to variable labels and descriptions than others.
The other options either use use <code><a href='http://www.rdocumentation.org/packages/foreign/topics/read.dta'>read.dta</a></code> or they use the `.MAP` dictionary file
provided with the DHS Stata datasets to reconstruct the variable labels and value labels.
In this case, value labels are stored are stored using the the `labelled` class from `haven`.
See `?haven::labelled` for more information. Variable labels are stored in the "label" attribute
 of each variable, the same as `haven::read_dta()`.</p>
<p>Currently, `mode="map"` is only implemented for 111 character fixed-width .MAP files, which comprises
the vast majority of recode data files from DHS Phases V, VI, and VII and some from Phase IV. Parsers
for other .MAP formats will be added in future.</p>
<p>Other available modes read labels from the Stata dataset with various options available in R:</p>
<p>* `mode="map"` uses the `.MAP` dictionary file provided with the DHS Stata datasets
to reconstruct the variable labels and value labels. In this case, value labels are stored are stored
using the the `labelled` class from `haven`. See `?haven::labelled` for more information. Variable labels
are stored in the "label" attribute of each variable, the same as `haven::read_dta()`.</p>
<p>* `mode="haven"`: use `haven::read_dta()` to read dataset. This option retains the native value codings
with value labels affixed with the 'labelled' class.</p>
<p>* `mode="foreign"`: use `foreign::read.dta()`, with default options convert.factors=TRUE to add
variable labels. Note that variable labels will not be added if labels are not present for all
values, but variable labels are available via the "val.labels" attribute.</p>
<p>* `mode="foreignNA"`: use `foreign::read.dta(..., convert.factors=NA)`, which converts any values
without labels to 'NA'. This risks data loss if labelling is incomplete in Stata datasets.</p>
<p>* `mode="raw"`: use `foreign::read.dta(..., convert.factors=FALSE)`, which simply loads underlying
value coding. Variable labels and value lables are still available through dataset attributes (see examples).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='http://www.rdocumentation.org/packages/foreign/topics/read.dta'>read.dta</a></code>, <code><a href='http://www.rdocumentation.org/packages/haven/topics/labelled'>labelled</a></code>, <code><a href='http://www.rdocumentation.org/packages/haven/topics/read_dta'>read_dta</a></code>.</p>
<p>For more information on the DHS filetypes and contents of distributed dataset .ZIP files,
see <a href='https://dhsprogram.com/data/File-Types-and-Names.cfm#CP_JUMP_10334'>https://dhsprogram.com/data/File-Types-and-Names.cfm#CP_JUMP_10334</a>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>mrdt_zip</span> <span class='kw'>&lt;-</span> <span class='fu'>tempfile</span>()
<span class='fu'>download.file</span>(<span class='fu'>paste0</span>(<span class='st'>"https://dhsprogram.com/customcf/legacy/data/sample_download_dataset.cfm?"</span>,
<span class='st'>"Filename=ZZMR61DT.ZIP&amp;Tp=1&amp;Ctry_Code=zz&amp;survey_id=0&amp;doctype=dhs"</span>), <span class='no'>mrdt_zip</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"wb"</span>)

<span class='no'>mr</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rdhs</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rdhs/topics/read_dhs_dta'>read_dhs_dta</a></span>(<span class='no'>mrdt_zip</span>,<span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"map"</span>)
<span class='fu'>attr</span>(<span class='no'>mr</span>$<span class='no'>mv213</span>, <span class='st'>"label"</span>)</div><div class='output co'>#&gt; [1] "partner currently pregnant"</div><div class='input'><span class='fu'>class</span>(<span class='no'>mr</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; [1] "labelled"</div><div class='input'><span class='fu'>head</span>(<span class='no'>mr</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; &lt;Labelled integer&gt;
#&gt; [1] NA  0  0 NA  0 NA
#&gt; 
#&gt; Labels:
#&gt;  value   label
#&gt;      0      no
#&gt;      1     yes
#&gt;      8  unsure
#&gt;      9 missing</div><div class='input'><span class='fu'>table</span>(<span class='no'>mr</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; 
#&gt;    0    1    8 
#&gt; 1766  239   57 </div><div class='input'><span class='fu'>table</span>(<span class='kw pkg'>haven</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/as_factor'>as_factor</a></span>(<span class='no'>mr</span>$<span class='no'>mv213</span>))</div><div class='output co'>#&gt; 
#&gt;      no     yes  unsure missing 
#&gt;    1766     239      57       0 </div><div class='input'>
<span class='co'>## If Stata file codebook is complete, `mode="map"` and `"haven"` should be the same.</span>
<span class='no'>mr_hav</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rdhs</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rdhs/topics/read_dhs_dta'>read_dhs_dta</a></span>(<span class='no'>mrdt_zip</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"haven"</span>)
<span class='fu'>attr</span>(<span class='no'>mr_hav</span>$<span class='no'>mv213</span>, <span class='st'>"label"</span>)</div><div class='output co'>#&gt; [1] "partner currently pregnant"</div><div class='input'><span class='fu'>class</span>(<span class='no'>mr_hav</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; [1] "labelled"</div><div class='input'><span class='fu'>head</span>(<span class='no'>mr_hav</span>$<span class='no'>mv213</span>)  <span class='co'># "9=missing" omitted from .dta codebook</span></div><div class='output co'>#&gt; &lt;Labelled double&gt;
#&gt; [1] NA  0  0 NA  0 NA
#&gt; 
#&gt; Labels:
#&gt;  value  label
#&gt;      0     no
#&gt;      1    yes
#&gt;      8 unsure</div><div class='input'><span class='fu'>table</span>(<span class='no'>mr_hav</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; 
#&gt;    0    1    8 
#&gt; 1766  239   57 </div><div class='input'><span class='fu'>table</span>(<span class='kw pkg'>haven</span><span class='kw ns'>::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/haven/topics/as_factor'>as_factor</a></span>(<span class='no'>mr_hav</span>$<span class='no'>mv213</span>))</div><div class='output co'>#&gt; 
#&gt;     no    yes unsure 
#&gt;   1766    239     57 </div><div class='input'>
## Parsing codebook when using foreign::read.dta()
# foreign issues with duplicated factors
# Specifying foreignNA can help but often will not as below.
# Thus we would recommend either using mode = "haven" or mode = "raw"
</div><span class='co'># NOT RUN {</span>
<span class='no'>mr_for</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rdhs</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rdhs/topics/read_dhs_dta'>read_dhs_dta</a></span>(<span class='no'>mrdt_zip</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"foreign"</span>)
<span class='no'>mr_for</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rdhs</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rdhs/topics/read_dhs_dta'>read_dhs_dta</a></span>(<span class='no'>mrdt_zip</span>, <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"foreignNA"</span>)
<span class='co'># }</span><div class='input'><span class='co'>## Don't convert factors</span>
<span class='no'>mr_raw</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>rdhs</span><span class='kw ns'>:::</span><span class='fu'><a href='http://www.rdocumentation.org/packages/rdhs/topics/read_dhs_dta'>read_dhs_dta</a></span>(<span class='no'>mrdt_zip</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"raw"</span>)
<span class='fu'>table</span>(<span class='no'>mr_raw</span>$<span class='no'>mv213</span>)</div><div class='output co'>#&gt; 
#&gt;    0    1    8 
#&gt; 1766  239   57 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by OJ Watson, Jeff Eaton.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

